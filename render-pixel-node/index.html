<body>
  <div id='punks'></div>
   <br>
  <script>
     function parseAscii( str ) {
      let ary = [];
      str.trim().split( "\n" ).forEach( line => {
           line = line.trim();
           if( line.startsWith( "#" ) || line.length == 0 ) {
             // do nothing; skip
           } else {
             values = line.split( /[ \t]+/ );
             ary.push( values );
           }
         } );
      return ary;
   }


   class Pixelart {
       constructor( pixels, options ) {
         this.pixels = pixels;

         this.colors = options.colors  || { '@': '#000000' }
         this.offset = options.offset  || [0,0];

         this.width  = pixels[0].length; // note: assume all rows the same for now
         this.height = pixels.length;

        //  console.log( `  width x height: ${this.width} x ${this.height}, offset: ${this.offset}` );
       }

       static parse( str, options ) {
          var pixels = parseAscii( str );
          return new Pixelart( pixels, options );
       }

       draw( ctx, zoom=1 ) {
         this.pixels.forEach( (row, y) => {
                   row.forEach( (pixel, x) => {

            if( pixel != '.' ) {  // auto-skip transparent for now - why? why not?
              ctx.fillStyle = this.colors[pixel];
              ctx.fillRect( x*zoom+this.offset[0]*zoom,
                            y*zoom+this.offset[1]*zoom, zoom, zoom );
            }
           });
         });
       }
   }


  function drawPunk( q, designs, zoom=1 ) {
    let canvas = document.querySelector( q )
    canvas.width  = designs[0].width*zoom;
    canvas.height = designs[0].height*zoom;
    let ctx = canvas.getContext( '2d' );
    for( let design of designs ) {
        design.draw( ctx, zoom );
    }
}

const example_design = `@`;

const parsed_design = Pixelart.parse( example_design, {
  colors: {
    '@':  '#000000',   
  }} );

      tag = document.createElement('canvas')
      tag.id = 'punk' + 0
      var element = document.getElementById('punks')
      element.appendChild(tag)
      drawPunk('#punk' + 0, [parsed_design], 20 )    
  </script>
</body>

